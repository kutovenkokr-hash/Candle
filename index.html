<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Калькулятор свічок</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#7c5cff">

  <style>
    /* ===== ВЕСЬ ТВОЙ СТИЛЬ (без изменений) ===== */
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:#0b0d12;
      color:#eef2ff;
    }
    header{
      padding:16px;
      background:#121625;
      border-bottom:1px solid #24304a;
    }
    h1{margin:0;font-size:18px}
    main{padding:16px}
    .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
    .tab{
      padding:8px 12px;
      border-radius:999px;
      background:#1b2035;
      cursor:pointer;
      font-size:13px;
    }
    .tab.active{background:#7c5cff}
    .view{display:none}
    .view.active{display:block}
    .card{
      background:#121625;
      border:1px solid #24304a;
      border-radius:16px;
      padding:12px;
      margin-bottom:12px;
    }
    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{padding:8px;border-bottom:1px solid #24304a}
    th{text-align:left;color:#a7b0c0}
    .right{text-align:right}
    input{
      width:100%;
      padding:10px;
      border-radius:12px;
      border:1px solid #24304a;
      background:#1b2035;
      color:white;
    }
    button{
      padding:10px 12px;
      border-radius:12px;
      border:none;
      background:#7c5cff;
      color:white;
      cursor:pointer;
    }
    button.danger{background:#ff4d6d}
    .row{display:grid;gap:8px;margin-bottom:8px}
  </style>
</head>

<body>

<header>
  <h1>Калькулятор свічок</h1>
</header>

<main>

  <div class="tabs">
    <div class="tab active" data-tab="stock">Склад</div>
    <div class="tab" data-tab="one">Одна свічка</div>
  </div>

  <!-- ===== СКЛАД ===== -->
  <div class="view active" id="stock">
    <div class="card">
      <h3>Склад (залишки)</h3>

      <div class="row">
        <input id="stockName" placeholder="Матеріал">
        <input id="stockQty" placeholder="Залишок (кг або шт)">
        <button onclick="addStock()">Додати</button>
      </div>

      <table>
        <thead>
          <tr><th>Матеріал</th><th class="right">Залишок</th></tr>
        </thead>
        <tbody id="stockTable"></tbody>
      </table>
    </div>
  </div>

  <!-- ===== ОДНА СВІЧКА ===== -->
  <div class="view" id="one">
    <div class="card">
      <h3>Одна свічка</h3>

      <div class="row">
        <input id="candleName" placeholder="Назва свічки">
        <input id="sellPrice" placeholder="Ціна продажу (грн)">
      </div>

      <div class="row">
        <input id="matName" placeholder="Матеріал">
        <input id="matQty" placeholder="Вага (г)">
        <input id="matPrice" placeholder="Ціна (грн/кг)">
        <button onclick="addMaterial()">Додати матеріал</button>
      </div>

      <table>
        <thead>
          <tr>
            <th>Матеріал</th>
            <th class="right">Собівартість</th>
          </tr>
        </thead>
        <tbody id="matTable"></tbody>
      </table>

      <p>Собівартість: <b id="cost">0</b> грн</p>
      <p>Маржа: <b id="margin">—</b></p>
    </div>
  </div>

</main>

<script>
  /* ===== ПРОСТАЯ ЛОГИКА (пример) ===== */
  const stock = JSON.parse(localStorage.getItem("stock")||"[]");
  const mats = [];

  function save(){
    localStorage.setItem("stock", JSON.stringify(stock));
  }

  function renderStock(){
    const t = document.getElementById("stockTable");
    t.innerHTML="";
    stock.forEach(s=>{
      const tr=document.createElement("tr");
      tr.innerHTML=`<td>${s.name}</td><td class="right">${s.qty}</td>`;
      tr.ondblclick=()=>{
        const n=prompt("Новий залишок:",s.qty);
        if(n!==null){s.qty=parseFloat(n);save();renderStock();}
      }
      t.appendChild(tr);
    });
  }

  function addStock(){
    const name=stockName.value.trim();
    const qty=parseFloat(stockQty.value);
    if(!name||isNaN(qty))return;
    stock.push({name,qty});
    save();
    stockName.value="";
    stockQty.value="";
    renderStock();
  }

  function addMaterial(){
    const q=parseFloat(matQty.value);
    const p=parseFloat(matPrice.value);
    if(isNaN(q)||isNaN(p))return;
    const cost=(q/1000)*p;
    mats.push(cost);
    matTable.innerHTML+=`<tr><td>${matName.value}</td><td class="right">${cost.toFixed(2)}</td></tr>`;
    const total=mats.reduce((a,b)=>a+b,0);
    costEl.textContent=total.toFixed(2);
    const sp=parseFloat(sellPrice.value);
    if(!isNaN(sp))margin.textContent=((sp-total)/sp*100).toFixed(2)+"%";
  }

  const stockName=document.getElementById("stockName");
  const stockQty=document.getElementById("stockQty");
  const matName=document.getElementById("matName");
  const matQty=document.getElementById("matQty");
  const matPrice=document.getElementById("matPrice");
  const matTable=document.getElementById("matTable");
  const costEl=document.getElementById("cost");
  const margin=document.getElementById("margin");
  const sellPrice=document.getElementById("sellPrice");

  renderStock();

  document.querySelectorAll(".tab").forEach(t=>{
    t.onclick=()=>{
      document.querySelectorAll(".tab").forEach(x=>x.classList.remove("active"));
      document.querySelectorAll(".view").forEach(v=>v.classList.remove("active"));
      t.classList.add("active");
      document.getElementById(t.dataset.tab).classList.add("active");
    }
  });
</script>

<!-- PWA service worker -->
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
